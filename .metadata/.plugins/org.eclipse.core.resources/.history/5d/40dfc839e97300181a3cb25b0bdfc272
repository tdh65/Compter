package test4;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.Statement;

public class Test {

	public static void main(String[] args) {
		try {
			Class.forName("org.postgresql.Driver");
			System.out.println("Driver ok ");

			String url = "jdbc:postgresql://192.168.1.53:5432/Ecole";
			String user = "postgres";
			String passwd = "bitnami";

			Connection conn = DriverManager.getConnection(url, user, passwd);
			System.out.println("connexion effective");
			// creation dun objet statement
			Statement state = conn.createStatement();

			// l objet resultset contient le resultat de la requete sql
			ResultSet result = state
					.executeQuery("SELECT PROF_ID As ID, Prof_NOM as Nom , Prof_PRENOM as Prenom FROM PROFESSEUR ");
			// on recupere les metadatas
			ResultSetMetaData resultMeta = result.getMetaData();
			int i = 1;
			System.out.println("\n\t---------------------------------------");
			System.out.println("\tLECTURE STANDARD.");
			System.out.println("\t---------------------------------------");
			

			while(result.next()) {
				affiche("\tNom : " + result.getString("Nom") + "\tpr√©nom : " + result.getString("Prenom")) ;
				// on regarde si c est le dernier resultat (derniere ligne ) 
				if (result.isLast())
					affiche("\t\t* DERNIER RESULTAT !\n");
			}
			// on affiche le nom des colonnes
			result.close();
			
			state.close();

		} catch (Exception e) {
			e.printStackTrace();
		}
	}
	public static void affiche(String str) {
		System.out.println(str);
	}

}
